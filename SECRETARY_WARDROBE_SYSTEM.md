# 秘书换装系统完整说明

## 系统概述

秘书换装系统为智学秘伴提供了完整的角色个性化功能。每个秘书角色都有独特的2D立绘，选择不同的服装会显示该秘书穿着该服装的专属立绘图片。

## 核心特性

### 1. 独特的角色形象

每个秘书都有自己独特的基础形象和风格：
- **经典系列**：小萌、优雅姐姐、温柔学姐、稳重叔叔、霸道总裁、阳光学长
- **古风系列**：玉环（贵妃）、墨渊（摄政王）、晴子（邻家大姐姐）、小荷（江南小妹）
- **奇幻系列**：艾莉希雅（精灵女王）、波波（史莱姆娘）、月影（狼族少女）、凤仪（女武神）、瓦尔基里（女骑士）

### 2. 专属服装立绘

每个秘书的每套服装都有对应的2D立绘：
- 同一服装在不同秘书身上呈现不同效果
- 立绘风格与秘书角色特征保持一致
- 全身立绘展示，清晰呈现服装细节

### 3. 实时预览系统

在角色展示框中实时显示当前选择的立绘：
- 选择秘书后立即显示默认立绘
- 切换服装时平滑更新立绘
- 支持大图预览和详细信息展示

## 已配置立绘统计

### 完整配置（10套服装）

#### 1. 小萌（可爱萝莉）
- **清新校园装** - 粉色校服，双马尾，青春活力
- **天使护士装** - 白色护士装，粉色边线，温柔可爱
- **经典女仆装** - 黑白女仆装，围裙，甜美服务
- **清新瑜伽服** - 粉色瑜伽服，运动活力
- **可爱连体泳衣** - 粉色泳衣，清凉可爱
- **甜美洛丽塔** - 粉色洛丽塔，蓬松裙摆，公主梦幻
- **传统和服** - 粉色和服，樱花图案，东方美
- **可爱卡通睡衣** - 粉色睡衣，温馨舒适
- **圣洁天使装** - 白色天使装，羽翼，纯洁美好
- **舒适居家服** - 粉色居家服，轻松自在

#### 2. 优雅姐姐（成熟御姐）
- **职业OL套装** - 黑色职业装，白衬衫，干练专业
- **知性教师装** - 米色教师装，眼镜，温柔知性
- **高级女仆装** - 黑色女仆长裙，优雅大方
- **专业瑜伽套装** - 紫色瑜伽装，运动背心，健康美
- **优雅比基尼套装** - 白色比基尼，高腰，成熟性感
- **蕾丝情趣套装** - 黑色蕾丝，性感优雅
- **经典旗袍** - 红色旗袍，金色刺绣，东方韵味
- **丝绸睡衣套装** - 深蓝丝绸睡衣，高贵优雅
- **哥特洛丽塔** - 黑色哥特装，神秘魅力
- **优雅连衣裙** - 深蓝连衣裙，优雅迷人

#### 3. 温柔学姐
- **清新校园装** - 白色校服，清纯可爱
- **天使护士装** - 粉色护士装，温柔体贴
- **经典女仆装** - 黑白女仆装，甜美大方
- **清新瑜伽服** - 薰衣草绿瑜伽服，清新自然
- **优雅网球裙** - 白色网球裙，百褶裙，活泼优雅
- **甜美洛丽塔** - 粉色洛丽塔，甜美可爱
- **现代改良和服** - 蓝白和服，清新雅致
- **清新夏日裙** - 碎花夏日裙，清新自然
- **可爱卡通睡衣** - 粉色睡衣，温馨舒适
- **舒适居家服** - 粉色居家服，轻松自在

### 基础配置（2-3套服装）

#### 4. 稳重叔叔（成熟男性）
- **职业装** - 黑色西装，成熟稳重
- **休闲装** - 灰色休闲装，轻松自在
- **运动装** - 运动休闲装，健康活力

#### 5. 霸道总裁（高冷男性）
- **职业装** - 黑色西装，霸气高冷
- **休闲装** - 灰色休闲装，干练帅气
- **运动装** - 健身装，强壮有力

#### 6. 阳光学长（青春男生）
- **校园装** - 白色校服，青春阳光
- **篮球服** - 运动装，活力四射
- **休闲装** - 清新休闲装，帅气迷人

#### 7. 玉环（贵妃）
- **宫装** - 红色宫装，华贵雍容
- **汉服** - 粉色汉服，优雅温婉
- **唐装** - 白色唐装，仙气飘逸

#### 8. 墨渊（摄政王）
- **宫装** - 黑色龙袍，威严霸气
- **汉服** - 蓝色汉服，高贵儒雅
- **唐装** - 白色唐装，清冷出尘

#### 9. 晴子（邻家大姐姐）
- **居家服** - 粉色居家服，温柔亲切
- **休闲装** - 白色休闲装，清新自然
- **夏日裙** - 碎花裙，温柔可人

#### 10. 小荷（江南小妹）
- **汉服** - 蓝白汉服，清新脱俗
- **唐装** - 粉色唐装，温婉可人
- **宫装** - 白色宫装，纯洁美好

#### 11. 艾莉希雅（精灵女王）
- **森林精灵装** - 绿色精灵装，金色装饰，神秘优雅
- **天使装** - 白色长裙，仙气飘逸

#### 12. 波波（史莱姆娘）
- **蓝色史莱姆形态** - 可爱Q萌
- **粉色史莱姆形态** - 甜美萌系
- **绿色史莱姆形态** - 清新自然

#### 13. 月影（狼族少女）
- **黑色狼装** - 野性帅气
- **灰色狼装** - 酷炫有型
- **白色狼装** - 高冷优雅

#### 14. 凤仪（女武神）
- **红色铠甲** - 英姿飒爽
- **白色战袍** - 优雅大方

#### 15. 瓦尔基里（女骑士）
- **银色铠甲** - 蓝色披风，高贵典雅
- **白色骑士装** - 纯洁高贵
- **黑色铠甲** - 帅气威武

## 数据库结构

### 核心表

1. **secretary_avatars** - 秘书形象表
   - 存储秘书的基本信息（名称、类型、描述等）
   - 每个秘书有唯一的ID

2. **secretary_outfits** - 服装表
   - 存储所有可用的服装信息
   - 包含42款不同风格的服装

3. **secretary_outfit_images** - 秘书服装立绘关联表
   - 存储每个秘书穿着特定服装的立绘图片
   - 关联秘书ID和服装ID
   - 每个组合有唯一的立绘URL

### 表关系

```
secretary_avatars (秘书)
    ↓ (1对多)
secretary_outfit_images (秘书+服装立绘)
    ↓ (多对1)
secretary_outfits (服装)
```

## 前端使用方法

### 1. 访问秘书形象页面

在侧边栏导航中点击"秘书形象"（Sparkles 图标），或直接访问 `/secretary` 路由。

### 2. 选择秘书角色

在"选择秘书"标签中：
- 浏览所有15个秘书角色
- 查看秘书的头像和简介
- 点击选择喜欢的秘书
- 选中的秘书会有高亮边框

### 3. 选择服装

切换到"选择服装"标签：
- 查看该秘书的所有可用服装
- 每个服装显示立绘缩略图
- 点击选择服装
- 选中的服装会有高亮边框

### 4. 预览立绘

在预览区域：
- 查看秘书穿着选中服装的完整立绘
- 查看秘书和服装的详细信息
- 确认选择无误

### 5. 保存配置

点击"保存配置"按钮：
- 保存当前的秘书和服装选择
- 应用到用户的个人配置
- 系统会在其他地方使用该配置

## 组件说明

### SecretaryDisplay 组件

**功能**：展示秘书穿着特定服装的立绘

**Props**：
- `secretaryAvatarId`: 秘书ID
- `outfitId`: 服装ID
- `secretaryName`: 秘书名称（可选）
- `outfitName`: 服装名称（可选）
- `className`: 自定义样式（可选）
- `showInfo`: 是否显示信息（默认true）

**特性**：
- 自动查询对应的立绘
- 支持加载状态显示
- 错误处理和回退方案
- 响应式设计

### SecretaryWardrobe 组件

**功能**：完整的秘书换装系统

**Props**：
- `userId`: 用户ID

**特性**：
- 秘书选择器
- 服装选择器
- 实时预览
- 配置保存

### SecretaryPage 页面

**功能**：秘书形象管理页面

**特性**：
- 功能说明
- 使用指南
- 集成换装系统

## 技术实现

### 数据查询

```typescript
// 查询秘书穿着特定服装的立绘
const { data } = await supabase
  .from('secretary_outfit_images')
  .select('image_url')
  .eq('secretary_avatar_id', secretaryId)
  .eq('outfit_id', outfitId)
  .maybeSingle();
```

### 关联查询

```typescript
// 查询秘书的所有可用服装
const { data } = await supabase
  .from('secretary_outfit_images')
  .select(`
    image_url,
    outfit:secretary_outfits(*)
  `)
  .eq('secretary_avatar_id', secretaryId);
```

### 配置保存

```typescript
// 保存用户的秘书配置
const { error } = await supabase
  .from('user_preferences')
  .upsert({
    user_id: userId,
    secretary_avatar_id: secretaryId,
    secretary_outfit_id: outfitId,
    secretary_name: secretaryName,
    secretary_enabled: true,
  });
```

## 扩展方向

### 短期扩展

1. **增加立绘数量**
   - 为每个秘书配置更多服装立绘
   - 目标：每个秘书至少15-20套服装

2. **优化用户体验**
   - 添加立绘切换动画
   - 支持立绘放大查看
   - 添加收藏功能

3. **增强交互**
   - 添加换装历史记录
   - 支持快速切换常用配置
   - 添加随机换装功能

### 长期扩展

1. **自定义立绘**
   - 支持用户上传自定义立绘
   - 提供立绘编辑工具
   - 社区立绘分享

2. **动态效果**
   - 立绘动画效果
   - 表情变化系统
   - 动作切换功能

3. **社交功能**
   - 立绘展示墙
   - 换装搭配分享
   - 立绘评分系统

## 数据统计

- **秘书总数**：15个
- **已配置立绘组合**：51个
- **服装总数**：42款
- **配置完成度**：
  - 完整配置（10套）：3个秘书
  - 基础配置（2-3套）：12个秘书
  - 平均每个秘书：3.4套服装

## 技术特点

### 灵活性
- 每个秘书可以独立配置服装立绘
- 支持任意秘书+服装组合
- 轻松添加新秘书或新服装

### 性能优化
- 图片懒加载减少初始加载时间
- 数据库索引优化查询速度
- 组件级别的状态管理

### 用户体验
- 直观的操作流程
- 实时的视觉反馈
- 友好的错误处理
- 响应式设计适配各种设备

### 可维护性
- 清晰的组件结构
- 完善的类型定义
- 详细的代码注释
- 统一的代码风格

## 注意事项

1. **立绘匹配**：确保立绘图片与秘书角色和服装风格匹配
2. **图片质量**：使用高质量的动漫风格立绘，全身展示
3. **风格统一**：同一秘书的不同服装立绘应保持角色特征一致
4. **性能考虑**：使用图片懒加载和缓存策略
5. **回退方案**：如果没有特定组合的立绘，显示秘书的默认立绘

## 总结

秘书换装系统为智学秘伴提供了丰富的角色个性化功能。通过为每个秘书配置独特的2D立绘，并支持服装切换，用户可以根据自己的喜好定制专属的学习秘书形象。系统设计灵活、易于扩展，为未来的功能增强奠定了良好的基础。
